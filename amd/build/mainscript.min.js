define("block_cinfo/mainscript",["exports","jquery","core/fragment","core/modal_factory"],(function(_exports,_jquery,_fragment,_modal_factory){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Manager for the accessreview block.
   *
   * @module      block_cinfo/mainscript
   * @author      Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @copyright   2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_fragment=_interopRequireDefault(_fragment),_modal_factory=_interopRequireDefault(_modal_factory);_exports.init=()=>{if((0,_jquery.default)("body.path-course-view div.course-content").length>0){var array=(0,_jquery.default)("#modarray").data("modarray");const tools=`<span id="cinfo-toolbar" class="d-block position-sticky">${(0,_jquery.default)("#cinfo-wrapper").html()}</span>`;(0,_jquery.default)(tools).insertBefore("div.course-content"),(0,_jquery.default)("#cinfo-toolbar #toolbar").hasClass("m41")&&(0,_jquery.default)("#cinfo-toolbar").css("top","0"),(0,_jquery.default)(".block_cinfo #cinfo-wrapper").remove(),(0,_jquery.default)(document).on("click","#btn-search",(function(){(0,_jquery.default)("#cinfo-block-search").toggleClass("d-none d-block"),(0,_jquery.default)("#cinfo-block-search input").focus(),(0,_jquery.default)("#cinfo-block-search input").val(""),(0,_jquery.default)("#cinfo-block-search .input-group").toggleClass("w-100"),(0,_jquery.default)("#searchresults").html(""),(0,_jquery.default)("#toolbar").css("opacity","0")})),(0,_jquery.default)(document).on("click","#cinfo-block-search .input-group-append.search-close",(function(){(0,_jquery.default)("#cinfo-block-search input").val(""),(0,_jquery.default)("#cinfo-block-search").toggleClass("d-none d-block"),(0,_jquery.default)("#cinfo-block-search .input-group").toggleClass("w-100"),(0,_jquery.default)("#searchresults").html(""),(0,_jquery.default)("#toolbar").css("opacity","1")})),(0,_jquery.default)(document).on("input","#cinfo-block-search input",(function(){var searchTerm=(0,_jquery.default)(this).val().toLowerCase();if(searchTerm.length>0){var searchResults=array.filter((function(item){return item.name.toLowerCase().indexOf(searchTerm)>-1})),searchResultsHTML="";searchResults.length>0?searchResults.forEach((function(item,index){searchResultsHTML+=`<a class="list-group-item px-2 py-1 text-left ${0==index?"active":""}"\n            href="${item.url}">${item.icon}${item.name}</a>`})):(0,_jquery.default)("#searchresults").html(""),(0,_jquery.default)("#searchresults").html(searchResultsHTML)}else(0,_jquery.default)("#searchresults").html("")})),(0,_jquery.default)(document).on("keydown","#cinfo-block-search input",(function(e){27===e.keyCode&&(e.preventDefault(),(0,_jquery.default)("#cinfo-block-search .input-group-append").trigger("click"));var current=(0,_jquery.default)("#searchresults a.list-group-item.active");if(40===e.keyCode){e.preventDefault();var next=current.next();next.length>0&&(current.removeClass("active"),next.addClass("active"))}if(38===e.keyCode){e.preventDefault();var prev=current.prev();prev.length>0&&(current.removeClass("active"),prev.addClass("active"))}13===e.keyCode&&(e.preventDefault(),current.length>0&&(window.location.href=current.attr("href")))}));const canScrollRight=()=>{const toolbar=document.querySelector("#cinfo-toolbar .scrollbar-0");return toolbar.scrollWidth-toolbar.scrollLeft-1>toolbar.clientWidth},canScrollLeft=()=>document.querySelector("#cinfo-toolbar .scrollbar-0").scrollLeft>0,checkScroll=()=>{canScrollLeft()?(0,_jquery.default)("#scroll-left").removeClass("d-none"):(0,_jquery.default)("#scroll-left").addClass("d-none"),canScrollRight()?(0,_jquery.default)("#scroll-right").removeClass("d-none"):(0,_jquery.default)("#scroll-right").addClass("d-none")};checkScroll(),(0,_jquery.default)(document).on("click","#scroll-right",(function(){const toolbar=document.querySelector("#cinfo-toolbar .scrollbar-0");toolbar.scrollBy({left:toolbar.clientWidth,behavior:"smooth"}),setTimeout(checkScroll,500)})),(0,_jquery.default)(document).on("click","#scroll-left",(function(){const toolbar=document.querySelector("#cinfo-toolbar .scrollbar-0");toolbar.scrollBy({left:-toolbar.clientWidth,behavior:"smooth"}),setTimeout(checkScroll,500)})),(0,_jquery.default)(window).on("resize",checkScroll),(0,_jquery.default)(document).on("click","#btn-courseinfo",(function(){const contextid=(0,_jquery.default)(this).data("contextid");_modal_factory.default.create({title:(0,_jquery.default)("#courseinfo-title").html(),body:_fragment.default.loadFragment("block_cinfo","course_intro",contextid,{contextid:contextid,parentcontextid:M.cfg.contextid}),large:!0,show:!1,removeOnClose:!0,isVerticallyCentered:!0}).then((modal=>{modal.show()})).fail((()=>{}))}))}}}));

//# sourceMappingURL=mainscript.min.js.map